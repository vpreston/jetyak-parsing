from gasex import sol
import numpy
import matplotlib.pyplot as plt

def convert_CH4(x, eff=0.15, peq=495.):
    ''' Method to convert the raw ppm measurements from the GGA to compensated
    uatm units '''
    gppm = 1.834 #hardcoded constant
    ui = peq * gppm / 1000.
    return (x * peq / 1000. - ui) / eff + ui

def apply_efficiency(x, eff=0.15, gppm=1.86):
    '''Method for applying the extraction efficiency'''
    return (x-gppm)/eff + gppm

CTD22_meth = [3.5518, 3.1656, 3.0464, 3.2566, 2.9212, 2.3416, 2.1555, 2.2008]
CTD22_temp = [9.3, 9.5, 10, 10.5, 10.8, 11.8, 13.4, 13.3]
CTD22_salt = [33.8, 33.8, 33.7, 33.7, 33.6, 33.3, 33.3, 33.3]
CTD22_depth = [45, 30, 25, 20, 12, 8, 5, 2]

CTD25_meth = [2.2409, 2.1931, 2.1193, 2.1154, 2.0875, 2.0015, 1.9745, 1.9566, 1.9383]
CTD25_temp = [9.4, 9.5, 10, 10.2, 10.2, 10.6, 11.4, 12.1, 13]
CTD25_salt = [33.9, 33.8, 33.8, 33.7, 33.5, 33.2, 33.1, 33, 32.4]
CTD25_depth = [65, 60, 50, 40, 30, 18, 8, 5, 2]

CTD23_meth = [6.1386, 3.2739, 2.8157, 2.6149, 2.3896, 2.2793, 2.1972, 2.1867]
CTD23_temp = [9.8, 10.3, 11, 11.2, 12.8, 13, 13.2, 13.3]
CTD23_salt = [33.8, 33.8, 33.7, 33.6, 33.5, 33.4, 33.4, 33.4]
CTD23_depth = [37, 30, 25, 20, 12, 8, 5, 3]

CTD24_meth = [3.1693, 3.3493, 2.8784, 2.6342, 2.6995, 2.5972, 2.0928, 2.0222]
CTD24_temp = [10.2, 10.5, 10.4, 11.3, 11.9, 11.7, 14, 14.4]
CTD24_salt = [33.8, 33.8, 33.8, 33.8, 33.6, 33.6, 33.4, 33.3]
CTD24_depth = [44, 40, 35, 30, 25, 20, 8, 3]


#CTD depth plot characteristics
CTD24_salt_standard = [33.30310346,
                       33.30760074,
                       33.3055031,
                       33.30876917,
                       33.30998609,
                       33.31883795,
                       33.32142828,
                       33.32809116,
                       33.37002008,
                       33.46931379,
                       33.46861224,
                       33.5416822,
                       33.55377252,
                       33.55386421,
                       33.56150149,
                       33.56108706,
                       33.56854511,
                       33.5728269,
                       33.5923404,
                       33.57518488,
                       33.60368747,
                       33.6358378,
                       33.63613433,
                       33.63986127,
                       33.63936995,
                       33.68275786,
                       33.66793417,
                       33.71295277,
                       33.75776197,
                       33.76264908,
                       33.76028978,
                       33.78023692,
                       33.80200063,
                       33.80350263,
                       33.81510524,
                       33.80568945,
                       33.82303406,
                       33.82651098,
                       33.83044317,
                       33.8338136,
                       33.83514735,
                       33.83461384,
                       33.83509598,
                       33.83544162]
CTD24_temp_standard = [12.09224688,
                       12.12494764,
                       12.08901412,
                       12.05302996,
                       12.00597713,
                       11.91873125,
                       11.86291379,
                       11.78711368,
                       11.53943735,
                       11.31824828,
                       11.37936395,
                       10.74047707,
                       10.62483136,
                       10.21325839,
                       9.92303694,
                       9.85635,
                       9.808609023,
                       9.845615736,
                       9.658076566,
                       9.75483498,
                       9.544010989,
                       9.253489024,
                       9.229914925,
                       9.15461348,
                       9.10677953,
                       8.93739434,
                       9.038829146,
                       8.836302553,
                       8.681160423,
                       8.684073398,
                       8.682343556,
                       8.590809231,
                       8.49701,
                       8.494693294,
                       8.44701619,
                       8.482224473,
                       8.417033188,
                       8.388907225,
                       8.370207317,
                       8.355766447,
                       8.34912449,
                       8.351398742,
                       8.347966495,
                       8.34523401]

CTD24_meth_standard = 1.86
CTD24_meth_standard_uatm = convert_CH4(CTD24_meth_standard, eff=1.0)/0.000001

CTD25_salt_standard = [32.46800442,
                       32.45354993,
                       32.72605539,
                       32.94306296,
                       32.90000648,
                       33.08674457,
                       33.13842118,
                       33.13661445,
                       33.16355667,
                       33.14206463,
                       33.19729588,
                       33.23062469,
                       33.23637834,
                       33.24424589,
                       33.25893133,
                       33.26651786,
                       33.25752357,
                       33.27457269,
                       33.29887957,
                       33.41351295,
                       33.38108841,
                       33.43929412,
                       33.47172342,
                       33.46579208,
                       33.48023761,
                       33.51189856,
                       33.51746061,
                       33.53287165,
                       33.5351053,
                       33.53484292,
                       33.55498485,
                       33.59151321,
                       33.62057703,
                       33.62876769,
                       33.63967582,
                       33.6616678,
                       33.67815211,
                       33.68875062,
                       33.68408452,
                       33.69432034,
                       33.70205623,
                       33.74918039,
                       33.74857444,
                       33.76294256,
                       33.77591646,
                       33.76545143,
                       33.78238811,
                       33.82991543,
                       33.79085208,
                       33.79133372,
                       33.81416223,
                       33.82286241,
                       33.82377653,
                       33.82897378,
                       33.83248283,
                       33.83568125,
                       33.84090894,
                       33.84570918,
                       33.84800218,
                       33.85613333,
                       33.86402642,
                       33.86274054,
                       33.88230674,
                       33.8699986,
                       33.86534573,
                       33.86357857]
CTD25_temp_standard = [13.17620829,
                       13.31578516,
                       12.52299915,
                       11.90462428,
                       12.07082642,
                       11.23819751,
                       10.86161662,
                       10.85909387,
                       10.549402,
                       10.72222279,
                       10.29964871,
                       9.798460494,
                       9.744402304,
                       9.669245205,
                       9.574316867,
                       9.484665476,
                       9.551942459,
                       9.473999104,
                       9.355951393,
                       9.001300719,
                       9.012246352,
                       8.991059804,
                       8.977047748,
                       8.992067327,
                       8.985784956,
                       8.957514388,
                       8.922932576,
                       8.842649485,
                       8.827743709,
                       8.824729167,
                       8.785390073,
                       8.713238365,
                       8.70160212,
                       8.698096923,
                       8.693269935,
                       8.692599153,
                       8.706861053,
                       8.717193827,
                       8.709958333,
                       8.706925285,
                       8.726199003,
                       8.674155882,
                       8.672004511,
                       8.633952893,
                       8.589381013,
                       8.567606667,
                       8.561817181,
                       8.539769753,
                       8.522529167,
                       8.519529786,
                       8.429614362,
                       8.391099291,
                       8.390464796,
                       8.371032317,
                       8.356144444,
                       8.338812019,
                       8.315432402,
                       8.283199016,
                       8.26578508,
                       8.223020139,
                       8.187832124,
                       8.182618533,
                       8.180405899,
                       8.167012045,
                       8.169327251,
                       8.166226531]

CTD25_meth_standard = 1.86
CTD25_meth_standard_uatm = convert_CH4(CTD25_meth_standard, eff=1.0)/0.000001

# print sol.sol_SP_pt(32.96061393433027, 12.674157889807788, gas='CH4', p_dry=1.86e6, units='mM')*0.000001
# print sol.sol_SP_pt(32.895899285428506, 12.92512536106512, gas='CH4', p_dry=1.86e6, units='mM')*0.000001



# nm = []
# for t, s in zip(CTD24_temp_standard, CTD24_salt_standard):
#     nm.append(sol.sol_SP_pt(s, t, gas='CH4', p_dry=1.86e6, units='mM')*0.000001)

# print nm
# plt.scatter(nm, CTD25_temp_standard)
# plt.xlabel('Methane, nM')
# plt.ylabel('Temperature, C')
# plt.show()
                       
nm = []

# CTD22_meth_uatm = [apply_efficiency(x)*0.000001 for x in CTD22_meth]
CTD25_meth_uatm = [apply_efficiency(x)*0.000001 for x in CTD25_meth]
# CTD23_meth_uatm = [apply_efficiency(x)*0.000001 for x in CTD23_meth]
# CTD24_meth_uatm = [apply_efficiency(x)*0.000001 for x in CTD24_meth]

# for m, t, s, d in zip(CTD22_meth_uatm, CTD22_temp, CTD22_salt, CTD22_depth):
#     nm.append(sol.sol_SP_pt(s, t, gas='CH4', p_dry=m, units='mM')/0.000001)

for m, t, s, d in zip(CTD25_meth_uatm, CTD25_temp, CTD25_salt, CTD25_depth):
    nm.append(sol.sol_SP_pt(s, t, gas='CH4', p_dry=m, units='mM')/0.000001)

# for m, t, s, d in zip(CTD23_meth_uatm, CTD23_temp, CTD23_salt, CTD23_depth):
#     nm.append(sol.sol_SP_pt(s, t, gas='CH4', p_dry=m, units='mM')/0.000001)

# for m, t, s, d in zip(CTD24_meth_uatm, CTD24_temp, CTD24_salt, CTD24_depth):
#     nm.append(sol.sol_SP_pt(s, t, gas='CH4', p_dry=m, units='mM')/0.000001)
print nm


# temp = convert_CH4(1.86, eff=1.0)/0.000001
# print sol.sol_SP_pt(31.39, 15.5, gas='CH4', p_dry=temp, units='mM')*0.000001
# print sol.sol_SP_pt(31.39, 15.5, gas='CH4', p_dry=1.84, units='mM')*0.000001